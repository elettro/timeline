<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Work &amp; Education Timeline</title>

  <!-- Google Fonts — if you change --font-body or --font-display in styles.css,
       update the family names in this URL to match. -->
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">

  <!-- Global stylesheet — all design tokens and component styles live here -->
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

  <!-- ── Page header ─────────────────────────────────────── -->
  <div class="page-header">
    <h1>Work &amp; Education History</h1>
    <p>Please enter details about your work experience and education.</p>
  </div>

  <!-- ── Top controls ────────────────────────────────────── -->
  <div class="controls">
    <button class="btn" onclick="openForm('add','experience')">+ Add Experience</button>
    <button class="btn" onclick="openForm('add','education')">+ Add Education</button>
  </div>

  <!-- ── Timeline ────────────────────────────────────────── -->
  <div class="timeline-wrapper">
    <div class="center-line"></div>
    <div id="timeline-body"></div>
  </div>

  <!-- ── Add / Edit form overlay ─────────────────────────── -->
  <div class="overlay" id="form-overlay">
    <div class="form-box">
      <h3 id="form-heading">Add Entry</h3>

      <!-- Hidden state fields -->
      <input type="hidden" id="form-mode"     value="add">
      <input type="hidden" id="form-edit-idx" value="-1">

      <div class="form-group">
        <label>Type</label>
        <select id="f-type">
          <option value="experience">Experience</option>
          <option value="education">Education</option>
        </select>
      </div>

      <div class="form-group">
        <label>Title / Degree</label>
        <input type="text" id="f-title" placeholder="e.g. Senior Designer">
      </div>

      <div class="form-group">
        <label>Company / Institution</label>
        <input type="text" id="f-org" placeholder="e.g. Acme Corp">
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Start Year</label>
          <input type="number" id="f-start" placeholder="2022" min="1950" max="2040">
        </div>
        <div class="form-group">
          <label>End Year</label>
          <input type="number" id="f-end" placeholder="Blank = Present" min="1950" max="2040">
        </div>
      </div>

      <div class="form-group">
        <label>Side</label>
        <select id="f-side">
          <option value="left">Left</option>
          <option value="right">Right</option>
        </select>
      </div>

      <div class="form-group">
        <label>Colour</label>
        <!-- Swatches injected by JS — colours controlled via COLORS array below -->
        <div class="color-swatches" id="color-swatches"></div>
        <input type="hidden" id="f-color" value="teal">
      </div>

      <div class="form-group">
        <label>Description <span style="text-transform:none;font-weight:400;opacity:.6">(optional)</span></label>
        <textarea id="f-desc" rows="2" placeholder="Brief description..."></textarea>
      </div>

      <div class="form-actions">
        <button class="btn-cancel" onclick="closeForm()">Cancel</button>
        <button class="btn-primary" id="submit-btn" onclick="submitForm()">Add to Timeline</button>
      </div>
    </div>
  </div>


  <!-- ================================================================
       JAVASCRIPT
       ================================================================
       NOTE: The COLORS array hex values must stay in sync with the
       --color-* custom properties in /css/styles.css (Section 1).
       If you add or rename a colour, update both places.
  ================================================================ -->
  <script>

    /* ── Colour palette ──────────────────────────────────────────────
       key   → CSS class applied to .card  (e.g. class="card teal")
       hex   → used to render the swatch circle in the form picker
       label → accessible tooltip on the swatch
    ----------------------------------------------------------------- */
    const COLORS = [
      { key: 'purple', hex: '#6c4fa3', label: 'Purple' },
      { key: 'teal',   hex: '#1a9b8a', label: 'Teal'   },
      { key: 'green',  hex: '#2e7d5e', label: 'Green'  },
      { key: 'pink',   hex: '#c23b6e', label: 'Pink'   },
      { key: 'red',    hex: '#b5293b', label: 'Red'    },
      { key: 'blue',   hex: '#2563b0', label: 'Blue'   },
      { key: 'orange', hex: '#c2620a', label: 'Orange' },
      { key: 'navy',   hex: '#1e3a5f', label: 'Navy'   },
    ];

    /* ── Build colour swatches (runs once on page load) ───────────── */
    const swatchWrap = document.getElementById('color-swatches');
    COLORS.forEach(c => {
      const s = document.createElement('div');
      s.className      = 'swatch';
      s.style.background = c.hex;
      s.dataset.color  = c.key;
      s.title          = c.label;
      s.addEventListener('click', () => pickColor(c.key));
      swatchWrap.appendChild(s);
    });

    function pickColor(key) {
      document.getElementById('f-color').value = key;
      document.querySelectorAll('.swatch').forEach(s =>
        s.classList.toggle('selected', s.dataset.color === key)
      );
    }
    pickColor('teal'); // default selection


    /* ── Timeline data ────────────────────────────────────────────────
       Each entry: { type, title, org, start, end, side, color, desc }
       type  : 'experience' | 'education'
       start : number (year)
       end   : number (year) | null  →  null renders as "Present"
       side  : 'left' | 'right'
       color : one of the COLORS[].key values above
    ----------------------------------------------------------------- */
    const entries = [
      {
        type: 'experience', side: 'left',  color: 'purple',
        title: 'Founder & Executive Producer', org: '',
        start: 2026, end: null,
        desc: 'Leading creative production and studio strategy.'
      },
      {
        type: 'experience', side: 'left',  color: 'teal',
        title: 'Partnerships & Head of...', org: 'DON PABLO COFFEE',
        start: 2025, end: 2026,
        desc: 'Managed key brand partnerships and strategic growth.'
      },
      {
        type: 'experience', side: 'left',  color: 'green',
        title: 'Lead AI Production...', org: 'ELETTRO INTERAC.',
        start: 2024, end: 2025,
        desc: 'Directed AI-driven interactive production pipelines.'
      },
      {
        type: 'experience', side: 'left',  color: 'pink',
        title: 'Global Organic Social Media Senior Project...', org: 'AUDIBLE AMAZON',
        start: 2023, end: 2024,
        desc: 'Oversaw global social content strategy across platforms.'
      },
      {
        type: 'education',  side: 'right', color: 'red',
        title: 'Business Administration', org: 'University',
        start: 2023, end: 2026,
        desc: 'Focused on entrepreneurship and marketing.'
      },
    ];


    /* ── Close dots menus on outside click ────────────────────────── */
    document.addEventListener('click', e => {
      if (!e.target.closest('.dots-wrapper'))
        document.querySelectorAll('.dots-menu.open')
                .forEach(m => m.classList.remove('open'));
    });


    /* ── Utility: year range across all entries ───────────────────── */
    function getYears() {
      if (!entries.length) return { min: 2022, max: 2026 };
      const all = entries.flatMap(e => [e.start, e.end || e.start]);
      return { min: Math.min(...all), max: Math.max(...all) };
    }


    /* ── Render the full timeline ─────────────────────────────────── */
    function renderTimeline() {
      const { min, max } = getYears();
      const body  = document.getElementById('timeline-body');
      body.innerHTML = '';
      const delay = { left: 0, right: 0 };

      for (let y = max + 1; y >= min - 1; y--) {

        // Year label on the spine
        const ym = document.createElement('div');
        ym.className = 'year-marker';
        ym.innerHTML = `<span class="year-label">${y}</span>`;
        body.appendChild(ym);

        const inYear = entries.filter(e => e.start === y);
        if (!inYear.length) continue;

        const lefts  = inYear.filter(e => e.side === 'left');
        const rights = inYear.filter(e => e.side === 'right');
        const rows   = Math.max(lefts.length, rights.length);

        for (let i = 0; i < rows; i++) {
          const L = lefts[i], R = rights[i];
          const row = document.createElement('div');
          row.className = 'row';
          row.innerHTML = `
            <div class="side left  ${L ? '' : 'empty'}">${L ? cardHTML(L, delay.left++)  : ''}</div>
            <div class="side right ${R ? '' : 'empty'}">${R ? cardHTML(R, delay.right++) : ''}</div>`;
          body.appendChild(row);

          // Wire delete buttons
          row.querySelectorAll('.delete-btn').forEach(btn =>
            btn.addEventListener('click', ev => {
              ev.stopPropagation();
              deleteEntry(parseInt(btn.dataset.idx));
            })
          );

          // Wire dots toggle
          row.querySelectorAll('.dots-toggle').forEach(btn =>
            btn.addEventListener('click', ev => {
              ev.stopPropagation();
              const menu    = btn.nextElementSibling;
              const wasOpen = menu.classList.contains('open');
              document.querySelectorAll('.dots-menu.open').forEach(m => m.classList.remove('open'));
              if (!wasOpen) menu.classList.add('open');
            })
          );

          // Wire edit button inside dots menu
          row.querySelectorAll('.edit-btn').forEach(btn =>
            btn.addEventListener('click', ev => {
              ev.stopPropagation();
              document.querySelectorAll('.dots-menu.open').forEach(m => m.classList.remove('open'));
              openForm('edit', null, parseInt(btn.dataset.idx));
            })
          );
        }
      }
    }


    /* ── Build card HTML string ───────────────────────────────────── */
    function cardHTML(e, d) {
      const idx   = entries.indexOf(e);
      const title = e.title.length > 38 ? e.title.slice(0, 36) + '\u2026' : e.title;
      const org   = e.org && e.org.length > 24 ? e.org.slice(0, 22) + '\u2026' : e.org;
      const dates = e.end ? `${e.start} \u2013 ${e.end}` : `${e.start} \u2013 Present`;

      return `
        <div class="card ${e.color}" data-idx="${idx}" style="animation-delay:${d * 80}ms">
          <div class="card-title">${title}</div>
          ${org ? `<div class="card-sub">${org}</div>` : ''}
          <div class="card-dates">${dates}</div>

          <div class="card-actions">

            <!-- Three-dot menu -->
            <div class="dots-wrapper">
              <button class="icon-btn dots-toggle" title="More options">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                  <circle cx="2"  cy="7" r="1.5"/>
                  <circle cx="7"  cy="7" r="1.5"/>
                  <circle cx="12" cy="7" r="1.5"/>
                </svg>
              </button>
              <div class="dots-menu">
                <button class="edit-btn" data-idx="${idx}">
                  <svg width="13" height="13" viewBox="0 0 13 13" fill="none"
                       stroke="currentColor" stroke-width="1.4">
                    <path d="M9 2l2 2L4 11H2V9L9 2z"/>
                  </svg>
                  Edit
                </button>
              </div>
            </div>

            <!-- Delete / trash button -->
            <button class="icon-btn danger delete-btn" data-idx="${idx}" title="Delete">
              <svg width="13" height="13" viewBox="0 0 13 14" fill="currentColor">
                <path d="M1 3.5h11M4.5 3.5V2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v1
                         M2.5 3.5l.6 7.6a1 1 0 0 0 1 .9h4.8a1 1 0 0 0 1-.9l.6-7.6"/>
              </svg>
            </button>

          </div>
        </div>`;
    }


    /* ── Delete an entry ──────────────────────────────────────────── */
    function deleteEntry(idx) {
      if (!confirm('Remove this entry from the timeline?')) return;
      entries.splice(idx, 1);
      renderTimeline();
    }


    /* ── Open the add / edit form ─────────────────────────────────── */
    function openForm(mode, typeHint, editIdx) {
      document.getElementById('form-mode').value     = mode;
      document.getElementById('form-edit-idx').value = editIdx !== undefined ? editIdx : -1;

      if (mode === 'edit' && editIdx >= 0) {
        const e = entries[editIdx];
        document.getElementById('form-heading').textContent = 'Edit Entry';
        document.getElementById('submit-btn').textContent   = 'Save Changes';
        document.getElementById('f-type').value  = e.type;
        document.getElementById('f-title').value = e.title;
        document.getElementById('f-org').value   = e.org   || '';
        document.getElementById('f-start').value = e.start;
        document.getElementById('f-end').value   = e.end   || '';
        document.getElementById('f-side').value  = e.side;
        document.getElementById('f-desc').value  = e.desc  || '';
        pickColor(e.color);
      } else {
        const isEdu = typeHint === 'education';
        document.getElementById('form-heading').textContent = isEdu ? 'Add Education' : 'Add Experience';
        document.getElementById('submit-btn').textContent   = 'Add to Timeline';
        document.getElementById('f-type').value  = typeHint || 'experience';
        document.getElementById('f-title').value = '';
        document.getElementById('f-org').value   = '';
        document.getElementById('f-start').value = '';
        document.getElementById('f-end').value   = '';
        document.getElementById('f-side').value  = isEdu ? 'right' : 'left';
        document.getElementById('f-desc').value  = '';
        pickColor(isEdu ? 'red' : 'teal');
      }
      document.getElementById('form-overlay').classList.add('active');
    }


    /* ── Close the form ───────────────────────────────────────────── */
    function closeForm() {
      document.getElementById('form-overlay').classList.remove('active');
    }

    // Also close on backdrop click
    document.getElementById('form-overlay').addEventListener('click', e => {
      if (e.target === e.currentTarget) closeForm();
    });


    /* ── Submit add or edit ───────────────────────────────────────── */
    function submitForm() {
      const title = document.getElementById('f-title').value.trim();
      const start = parseInt(document.getElementById('f-start').value);
      if (!title || isNaN(start)) {
        alert('Please enter at least a title and start year.');
        return;
      }

      const entry = {
        type:  document.getElementById('f-type').value,
        title,
        org:   document.getElementById('f-org').value.trim(),
        start,
        end:   parseInt(document.getElementById('f-end').value) || null,
        side:  document.getElementById('f-side').value,
        color: document.getElementById('f-color').value,
        desc:  document.getElementById('f-desc').value.trim(),
      };

      const mode    = document.getElementById('form-mode').value;
      const editIdx = parseInt(document.getElementById('form-edit-idx').value);

      if (mode === 'edit' && editIdx >= 0) entries[editIdx] = entry;
      else entries.push(entry);

      closeForm();
      renderTimeline();
    }


    /* ── Initial render ───────────────────────────────────────────── */
    renderTimeline();

  </script>
</body>
</html>
